-- Total Customers
SELECT COUNT(*) AS total_customers
FROM customers;

-- Total Revenue
SELECT SUM(p.price * o.quantity) AS total_revenue
FROM orders o
JOIN products p ON o.product_id = p.product_id;

-- Top Customers by Spending
SELECT c.customer_name,
       SUM(p.price * o.quantity) AS total_spent
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN products p ON o.product_id = p.product_id
GROUP BY c.customer_name
ORDER BY total_spent DESC;

-- Most Popular Products
SELECT p.product_name,
       SUM(o.quantity) AS total_quantity_sold
FROM orders o
JOIN products p ON o.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity_sold DESC;

-- Country-wise Revenue
SELECT c.country,
       SUM(p.price * o.quantity) AS revenue
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN products p ON o.product_id = p.product_id
GROUP BY c.country
ORDER BY revenue DESC;

-- Monthly Sales Trend
SELECT strftime('%Y-%m', order_date) AS month,
       SUM(p.price * o.quantity) AS monthly_sales
FROM orders o
JOIN products p ON o.product_id = p.product_id
GROUP BY month
ORDER BY month;
